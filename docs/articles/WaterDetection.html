<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to Water Detection • WaterDetection</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Water Detection">
<meta property="og:description" content="WaterDetection">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WaterDetection</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/WaterDetection.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Pedro-Fernandes-Remote-Sensing/WaterDetection/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to Water Detection</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Pedro-Fernandes-Remote-Sensing/WaterDetection/blob/HEAD/vignettes/WaterDetection.Rmd" class="external-link"><code>vignettes/WaterDetection.Rmd</code></a></small>
      <div class="hidden name"><code>WaterDetection.Rmd</code></div>

    </div>

    
    
<p><strong>This Vignette was produced using RMarkdown documentation, you
can find most of the syntax here: <a href="https://www.markdownguide.org/cheat-sheet/" class="external-link uri">https://www.markdownguide.org/cheat-sheet/</a></strong>
<strong>This package was built using library(devtools) for package
building, library(roxygen2) for documentation, library(pkgdown) for
building docs folder</strong> <br><br> Welcome to the Introduction
to the “WaterDetection” package. In this Vignette I will run you through
the necessary steps to use this package and produce time-series graphs
that represent the amount of water in a group of Zones of Interest
(ZOI). <br></p>
<div class="section level3">
<h3 id="main-setup-and-data">Main Setup and Data<a class="anchor" aria-label="anchor" href="#main-setup-and-data"></a>
</h3>
<p><strong>1</strong> - The first step would obviously be to install and
load our package, “WaterDetection”. Use Packages &gt; Install from file
and use the file (.tar.gz probably) provided. Then load the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Pedro-Fernandes-Remote-Sensing/WaterDetection" class="external-link">WaterDetection</a></span><span class="op">)</span></span></code></pre></div>
<p>or use this line, that will work as soon as our package is available
on RCAN:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/Pedro-Fernandes-Remote-Sensing/WaterDetection" class="external-link">'WaterDetection'</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'WaterDetection'</span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span> <span class="op">(</span><span class="st"><a href="https://github.com/Pedro-Fernandes-Remote-Sensing/WaterDetection" class="external-link">'WaterDetection'</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>2</strong> - We will need data, and as such you should define
variables (lists) with your satellite imagery data. In this package,
we’d like to have a list of file paths. The path used should point to a
folder where you can find <strong>pre-processed monthly
composites</strong> that correspond to a single year. This should be
done <strong>once for each year of data</strong> (you should organize
data 1 folder = 12 months of data) you’d like to use. Make sure to
include <strong>full.names = TRUE</strong>. For one year, Example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CompositeListYearX</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Whatever_File_Path"</span>, pattern <span class="op">=</span> <span class="st">"Whatever_Identifying_Pattern"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Or, for a set of 6 years (2017, 2018, 2019, 2020, 2021, 2022):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CompositeListYear2017</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Whatever_File_Path"</span>, pattern <span class="op">=</span> <span class="st">"Whatever_Identifying_Pattern"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">CompositeListYear2018</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Whatever_File_Path"</span>, pattern <span class="op">=</span> <span class="st">"Whatever_Identifying_Pattern"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">CompositeListYear2019</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Whatever_File_Path"</span>, pattern <span class="op">=</span> <span class="st">"Whatever_Identifying_Pattern"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">CompositeListYear2020</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Whatever_File_Path"</span>, pattern <span class="op">=</span> <span class="st">"Whatever_Identifying_Pattern"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">CompositeListYear2021</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Whatever_File_Path"</span>, pattern <span class="op">=</span> <span class="st">"Whatever_Identifying_Pattern"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">CompositeListYear2022</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Whatever_File_Path"</span>, pattern <span class="op">=</span> <span class="st">"Whatever_Identifying_Pattern"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>3</strong> - This algorithm also uses the NDVI. If you
already have NDVI calculated for each month of your data, you should now
define lists that contain the file paths for NDVI. Otherwise you need to
calculate it. This should be done <strong>once for each year of
data</strong> (you should organize data 1 folder = 12 months of data)
you’d like to use. Make sure to include <strong>full.names =
TRUE</strong>. For one year, again:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NDVIListYearX</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Whatever_File_Path"</span>, pattern <span class="op">=</span> <span class="st">"Whatever_Identifying_Pattern"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Or, for a set of 6 years (2017, 2018, 2019, 2020, 2021, 2022):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NDVIListYear2017</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Whatever_File_Path"</span>, pattern <span class="op">=</span> <span class="st">"Whatever_Identifying_Pattern"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">NDVIListYear2018</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Whatever_File_Path"</span>, pattern <span class="op">=</span> <span class="st">"Whatever_Identifying_Pattern"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">NDVIListYear2019</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Whatever_File_Path"</span>, pattern <span class="op">=</span> <span class="st">"Whatever_Identifying_Pattern"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">NDVIListYear2020</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Whatever_File_Path"</span>, pattern <span class="op">=</span> <span class="st">"Whatever_Identifying_Pattern"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">NDVIListYear2021</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Whatever_File_Path"</span>, pattern <span class="op">=</span> <span class="st">"Whatever_Identifying_Pattern"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">NDVIListYear2022</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Whatever_File_Path"</span>, pattern <span class="op">=</span> <span class="st">"Whatever_Identifying_Pattern"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>4</strong> and <strong>5</strong> - Now it would take ages
and it would be counter-productive (and also not very accurate) to apply
this algorithm to the entirety of our data. As such, it is recommended
that you produce a <strong>shapefile (.shp)</strong> with <strong>ZOI
(Zones of Interest)</strong>. These zones should be zones where water is
expected to be (say zones defining damns, lakes). Then, define a
variable with a path to that shapefile, and another variable with the
shapefile name. <strong>These variables should be global, if possible
(using &lt;&lt;- instead of &lt;-). However, caution using global
variables regarding your overall work.</strong> Example:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ZOI_Shapefile_Path</span> <span class="op">&lt;&lt;-</span> <span class="st">"Whatever_Shapefile_Path"</span></span>
<span><span class="va">Shapefile_Name</span> <span class="op">&lt;&lt;-</span> <span class="st">"Whatever_Shapefile_Name"</span></span></code></pre></div>
<p><strong>6</strong> - Now we should define a variable with a list of
years that we will calculate. This will help other functions work
properly. Other solutions might automate this but it will severely
complicate the code without any real need. Let’s say you’re using 6
years of data as per previous example. <strong>This variable should be
global, if possible (using &lt;&lt;- instead of &lt;-). However, caution
using global variables regarding your overall work.</strong> Then:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Year_List</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">2017</span>,<span class="fl">2018</span>,<span class="fl">2019</span>,<span class="fl">2020</span>,<span class="fl">2021</span>,<span class="fl">2022</span><span class="op">)</span></span></code></pre></div>
<p><strong>7</strong> - Now let’s define a path for the general output
of our Algorithm. This path will eventually contain all the images for
all ZOIs from every step of the process. Let’s say:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Output_Path</span> <span class="op">&lt;&lt;-</span> <span class="st">"Whatever_Path"</span></span></code></pre></div>
<p><strong>8</strong> and <strong>9</strong> - This algorithm uses both
NDVI and a sum of RGB bands to detect water. We should now define what
thresholds it should use to differentiate water from non-water. Define
two variables, one for <strong>NDVI_Threshold</strong> and one for
<strong>RGBSum_Threshold</strong>. I recommend 0 and 800, respectively.
These variables should be a list with just one element. This was a
preparation for further automation that wasn’t completed (multiple
thresholds per run). As such:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NDVI_Threshold</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">RGBSum_Threshold</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">800</span><span class="op">)</span></span></code></pre></div>
<p><strong>10</strong> - Although not perfectly automated, there is
still a severe amount of automation in this package. We can now automate
the creation of output folders in the output path we created in step 7.
Using the function <strong>CreateOutputFolders()</strong> with the
arguments <strong>Year_List</strong> from step 6 and
<strong>OutputPath</strong> from step 7. Keep in mind this function has
no return.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">CreateOutputFolders</span><span class="op">(</span><span class="va">Year_List</span>, <span class="va">Output_Path</span><span class="op">)</span></span></code></pre></div>
<strong>11</strong> - Good news and bad news. The bad news is this
package uses a lot of different export paths, and thus they need to be
defined. The good news are the process is automated! Simply use
<strong>GenerateExportPaths()</strong>. You should have an export path
for all these different things (a set for each year): <br><ol><ol style="list-style-type: decimal">
<li>NDVI_All</li>
<li>Composite_All</li>
<li>RGBSum_All</li>
<li>NDVI_Binary_All</li>
<li>RGBSum_Binary_All</li>
<li>Algorithm_All</li>
<li>NDVI_Individual</li>
<li>Composite_Individual</li>
<li>RGBSum_Individual</li>
<li>NDVI_Binary_Individual</li>
<li>Algorithm_Individual</li>
<li>CSV_Export_Path</li>
<li>Individual_Graphs</li>
<li>Individual_Graphs_Overlap</li>
<li>Individual_Shapefiles</li>
</ol></ol>
<p><br> Simply use as argument the year list from step 6 and the
output path from step 7:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GenerateExportPaths.html">GenerateExportPaths</a></span><span class="op">(</span><span class="va">Year_List</span>, <span class="va">Output_Path</span><span class="op">)</span></span></code></pre></div>
<p><strong>12</strong> - Now let’s use
<strong>CropShapefile_ExportToPath()</strong> to cut the Shapefile that
contains our ZOI into diferent shapefiles, one for each ZOI. This is
useful for later processing and also to build maps in GIS software
(since we now have the boundaries of each ZOI). Note that I used
<strong>ZOI_Shapefile_Path</strong>, <strong>Shapefile_Name</strong> and
<strong>ExportPath_Shapefiles</strong> from steps 4, 5 and 14. This
function will return a list of individual shapefile objects (ordered by
OBJECT_ID from the atribute table), which we will store in a variable
<strong>ZOI_Shapefile_List</strong>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ZOI_Shapefile_List</span> <span class="op">=</span> <span class="fu"><a href="../reference/CropShapefile_ExportToPath.html">CropShapefile_ExportToPath</a></span><span class="op">(</span><span class="va">ZOI_Shapefile_Path</span>, <span class="va">Shapefile_Name</span>, <span class="va">ExportPath_Shapefiles</span><span class="op">)</span></span></code></pre></div>
<p><strong>13</strong> - Then you should build some vectors that will be
used to reclassify rasters later. Use <strong>VectorBuilder()</strong>
with the values defined in step 8 and 9. Remenber to define lists in
step 8 and 9 and then call the first element of each list using
[[1]]:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/VectorBuilder.html">VectorBuilder</a></span><span class="op">(</span><span class="va">NDVI_Threshold</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">RGBSum_Threshold</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="processing-steps-by-year">Processing Steps by Year<a class="anchor" aria-label="anchor" href="#processing-steps-by-year"></a>
</h2>
<p>I will now give you a run down of steps to take for each year of data
you use. Later, all of the results of these processes will be put
together to help us build time-series graphs for each ZOI.</p>
<div class="section level3">
<h3 id="processing-ndvi">Processing NDVI<a class="anchor" aria-label="anchor" href="#processing-ndvi"></a>
</h3>
<p><strong>14</strong> - R works best when you turn your raster data
into workable “stacks” or “bricks”. In this case, we will use
<strong>BuildBrickList()</strong> to transform our
<strong>NDVIListYearX</strong> into workable “bricks”. Simply:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NDVI_YearX_BL</span> <span class="op">=</span> <span class="fu"><a href="../reference/BuildBrickList.html">BuildBrickList</a></span><span class="op">(</span><span class="va">NDVIListYearX</span><span class="op">)</span></span></code></pre></div>
<p><strong>15</strong> - Now we can the function CropAndMask() to, well,
Crop and Mask our data to the areas defined by our Shapefile. This will
severely reduce processing time, as areas where Water is expected are a
relatively low percentage of the total area. Note that I used
<strong>NDVI_YearX_BL</strong> from step 14. Example:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NDVI_YearX_ZOI</span> <span class="op">=</span> <span class="fu"><a href="../reference/CropAndMask.html">CropAndMask</a></span><span class="op">(</span><span class="va">NDVI_YearX_BL</span>, <span class="va">Shapefile_Path</span>, <span class="va">Shapefile_Name</span><span class="op">)</span></span></code></pre></div>
<p><strong>16</strong> - We now have NDVI, relating to Year X,
exclusively inside the ZOIs. We can use <strong>ExportRasters()</strong>
to save those rasters, just in case we need them for some sort of
analysis. Please note I used as arguments the NDVI to be exported, the
ExportPath for NDVI_All (as produced in step 11), a string for a general
file name (month name will be appended in the end so please end the name
with _), a string to print as each NDVI is exported and a string to
print in the end. These strings are useful if you ever need to debug
something. As such:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ExportRasterList.html">ExportRasterList</a></span><span class="op">(</span><span class="va">NDVI_YearX_ZOI</span>, <span class="va">ExportPath_NDVI_All_YearX</span>, <span class="st">"NDVI_All_YearX_"</span>, <span class="st">"Finished Exporting NDVI "</span>, <span class="st">"Finished Exporting all NDVI"</span><span class="op">)</span></span></code></pre></div>
<p><strong>17</strong> - We now need to create individual folders for
each ZOI. These folders will store the Individual NDVI, organized by
ZOI. We can use <strong>CreateIndividualFolders()</strong>, with
<strong>ExportPath_NDVI_Individual_YearX</strong> (as per step 11) and
<strong>ID_list</strong> (global variable produced with step 12 that
represents a list of OBJECT_ID, one for each ZOI). That being said:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/CreateIndividualFolders.html">CreateIndividualFolders</a></span><span class="op">(</span><span class="va">ExportPath_NDVI_Individual_YearX</span>, <span class="va">ID_list</span><span class="op">)</span></span></code></pre></div>
<p><strong>18</strong> - We can now cut and export the monthly NDVI for
each ZOI and store them in a matrix. Matrix[[1]] is a list of monthly
NDVI for ZOI 1 and Matrix[[1]][[1]] is the the first month of the
agricultural Year X for ZOI 1 (assuming entry data is 12 months and
sorted by Agricultural Year). Use <strong>Individual_Product()</strong>
with arguments: <strong>NDVI_YearX_ZOI</strong> from step 18,
<strong>ZOI_Shapefile_List</strong> from step 12,
<strong>ExportPath_NDVI_Individual_YearX</strong> from step 11, ID_list
(global variable) from step 12, a name for each file (string “XXX_”, as
the function will attach the ZOI ID in the end), a string to print as
each NDVI is exported, a string to print as each ZOI is completed and a
string to print in the end;</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NDVI_YearX_IndividualZOI_ListOfLists</span> <span class="op">=</span> <span class="fu">IndividualProduct</span><span class="op">(</span><span class="va">NDVI_YearX_ZOI</span>, <span class="va">ZOI_Shapefile_List</span>, <span class="va">ExportPath_NDVI_Individual_YearX</span>, <span class="va">ID_list</span>, <span class="st">"NDVI_YearX_ZOI_"</span>, <span class="st">"Singular NDVI Exported "</span>, <span class="st">"Completed ZOI "</span>, <span class="st">"Completed All ZOI"</span><span class="op">)</span></span></code></pre></div>
<p><strong>19</strong> - Although we have the normal NDVI, we will need
to reclassify it using our <strong>NDVI_Threshold</strong> from step 8.
This, in conjunction with a reclassified RGBSum (to be done later) will
produce our Water Detection algorithm. For this matter, you can use
<strong>ReclassRasterList()</strong>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NDVI_YearX_ZOI_Binary</span> <span class="op">=</span> <span class="fu"><a href="../reference/ReclassRasterList.html">ReclassRasterList</a></span><span class="op">(</span><span class="va">NDVI_YearX_ZOI</span>, <span class="va">VectorNDVI</span>, <span class="st">"Reclassfied NDVI "</span>, <span class="st">"Reclassified all NDVI"</span><span class="op">)</span></span></code></pre></div>
<p><strong>20</strong> - Better to export it just in case we need it
later for some other purpose.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ExportRasterList.html">ExportRasterList</a></span><span class="op">(</span><span class="va">NDVI_YearX_ZOI_Binary</span>, <span class="va">ExportPath_NDVI_All_YearX</span>, <span class="st">"NDVI_All_YearX_"</span>, <span class="st">"Finished Exporting NDVI "</span>, <span class="st">"Finished Exporting all NDVI"</span><span class="op">)</span></span></code></pre></div>
<p><strong>21</strong> - Let’s create some more folders for each ZOI,
named after the threshold selected in step 8, using
<strong>CreateIndividualFolders2()</strong> this time, since it takes as
input an additional argument:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/CreateIndividualFolders2.html">CreateIndividualFolders2</a></span><span class="op">(</span><span class="va">ExportPath_NDVI_Binary_Individual_YearX</span>, <span class="va">ID_lis</span>, <span class="va">NDVI_Threshold</span><span class="op">)</span></span></code></pre></div>
<p><strong>22</strong> - We can now cut and export the monthly
Binary_NDVI for each ZOI and store them in a matrix. Matrix[[1]] is a
list of monthly Binary NDVI for ZOI 1 and Matrix[[1]][[1]] is the the
first month of the agricultural Year X for ZOI 1 (assuming entry data is
12 months and sorted by Agricultural Year). Use
<strong>Individual_Product2()</strong> with arguments:
<strong>NDVI_YearX_ZOI_Binary</strong> from step 18,
<strong>ZOI_Shapefile_List</strong> from step 12,
<strong>ExportPath_NDVI_Binary_Individual_YearX</strong> from step 11,
ID_list (global variable) from step 12, a name for each file (string
“XXX_”, as the function will attach the ZOI ID in the end), a string to
print as each Bianry NDVI is exported, a string to print as each ZOI is
completed and a string to print in the end;</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>NDVI_Binary_YearX_IndividualZOI_ListofLists <span class="ot">=</span> <span class="fu">IndividualProduct2</span>(NDVI_YearX_ZOI, ZOI_Shapefile_List, ExportPath_NDVI_Individual_YearX, NDVI_Threshold[[<span class="dv">1</span>]], ID_list, <span class="st">"NDVI_YearX_ZOI_"</span>, <span class="st">"Singular NDVI Exported "</span>, <span class="st">"Completed ZOI "</span>, <span class="st">"Completed All ZOI"</span>)<span class="er">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="processing-rgbsum">Processing RGBSum<a class="anchor" aria-label="anchor" href="#processing-rgbsum"></a>
</h3>
<p><strong>23</strong> - This is a similar process to NDVI. First let’s
start by building Bricks from our data using
<strong>BuildBrickList()</strong> and
<strong>CompositeListYearX</strong> from step 2:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Composite_YearX_BL</span> <span class="op">=</span> <span class="fu"><a href="../reference/BuildBrickList.html">BuildBrickList</a></span><span class="op">(</span><span class="va">CompositeListYearX</span><span class="op">)</span></span></code></pre></div>
<p><strong>24</strong> - Let’s now Crop and Mask our data to our
original Shapefile using <strong>CropAndMask()</strong>,
<strong>ZOI_Shapefile_Path</strong> and <strong>Shapefile_Name</strong>
from step 2:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Composite_YearX_ZOI</span> <span class="op">=</span> <span class="fu"><a href="../reference/CropAndMask.html">CropAndMask</a></span><span class="op">(</span><span class="va">Composite_YearX_BL</span>, <span class="va">Shapefile_Path</span>, <span class="va">Shapefile_Name</span><span class="op">)</span></span></code></pre></div>
<p><strong>25</strong> - Export the result of CropAndMask, using
<strong>ExportPath()</strong> and
<strong>ExportPath_Composite_All_YearX</strong>, just in case we need
later. Remeber to add a name for the file (XXX_, as the function will
attach month name to the end, assuming data is 12 month and sorted by
agricultural year), a string to print after each month is exported and a
string to print in the end:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ExportRasterList.html">ExportRasterList</a></span><span class="op">(</span><span class="va">Composite_YearX_ZOI</span>, <span class="va">ExportPath_Composite_All_YearX</span>, <span class="st">"Composite_All_YearX_"</span>, <span class="st">"Finished Exporting Composite "</span>, <span class="st">"Finished Exporting all Composites"</span><span class="op">)</span></span></code></pre></div>
<p><strong>26</strong> - Let’s make sure we have individual folders for
the Individual Composites by running
<strong>CreateIndividualFolders()</strong> using
<strong>ExportPath_Composite_Individual_YearX</strong> and
<strong>ID_list</strong>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/CreateIndividualFolders.html">CreateIndividualFolders</a></span><span class="op">(</span><span class="va">ExportPath_Composite_Individual_YearX</span>, <span class="va">ID_list</span><span class="op">)</span></span></code></pre></div>
<p><strong>27</strong> - Now let’s again cut and export the monthly
Composites for each ZOI and store them in a matrix where Matrix[[1]] is
a list of monthly Composite for ZOI 1 and Matrix[[1]][[1]] is the the
first month of the agricultural Year X for ZOI 1 (assuming entry data is
12 months and sorted by Agricultural Year) using as arguments:
<strong>Composite_YearX_ZOI</strong> from step 24,
<strong>ZOI_Shapefile_List</strong> from step 15,
<strong>ExportPath_Composite_Individual_YearX</strong> from step 11,
<strong>ID_list</strong> (global variable that should be created from
running step 12), a string name for the files (XXX_, as the function
will attach ZOI ID and month to the end), a string to print as each
composite is exported, a string to print as each ZOI is finished and a
string to print in the end;</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NDVI_YearX_IndividualZOI_ListOfLists</span> <span class="op">=</span> <span class="fu">IndividualProduct</span><span class="op">(</span><span class="va">Composite_YearX_ZOI</span>, <span class="va">ZOI_Shapefile_List</span>, <span class="va">ExportPath_Composite_Individual_YearX</span>, <span class="va">ID_list</span>, <span class="st">"Composite_YearX_ZOI_"</span>, <span class="st">"Singular Composite Exported "</span>, <span class="st">"Completed ZOI "</span>, <span class="st">"Completed All ZOI"</span><span class="op">)</span></span></code></pre></div>
<p><strong>28</strong> -</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Pedro Fernandes.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
